<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <title></title>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/jquery.mCustomScrollbar.min.css">
    <link rel="stylesheet" href="css/index.css">
</head>
<body>
<div class="title">
    <img class="title-img" src="./images/top_title1@2x.png" alt="">
    <div class="time-sign">
        <p>2020年5月23日 星期六 晴天</p>
        <p class="level-explain">
            <span>保驾等级: XXX</span>
            <span>运行图: XXXX</span>
        </p>
    </div>
</div>
<div class="table-box">
    <div class="table-item">
        <table>
            <thead>
            <tr>
                <th width="6%">序号</th>
                <th width=6%">车次</th>
                <th width="15%">计划车号</th>
                <th width="8%">股道</th>
                <th width="15%">计划出库时间</th>
                <th width="10%">实际车号</th>
                <th width="15%">实际出库时间</th>
                <th width="25%">备注</th>
            </tr>
            </thead>
        </table>
        <div id="leftTable">
            <table>
                <thead>
                <tr>
                    <th width="6%">序号</th>
                    <th width=6%">车次</th>
                    <th width="15%">计划车号</th>
                    <th width="8%">股道</th>
                    <th width="15%">计划出库时间</th>
                    <th width="10%">实际车号</th>
                    <th width="15%">实际出库时间</th>
                    <th width="25%">备注</th>
                </tr>
                </thead>
                <tbody id="leftBody">
                <tr>
                    <td>1</td>
                    <td>0401</td>
                    <td>0417</td>
                    <td>01A</td>
                    <td><div class="time">2020-05-23 11:00</div></td>
                    <td width="30%">
                        <a class="comment">这这里这这里是备注这里是备注里是备注这这里是备注这里是备注里是备注是备注这里是备注里是备注</a>
                    </td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>0401</td>
                    <td>0417</td>
                    <td>01A</td>
                    <td><div class="time">2020-05-23 11:00</div></td>
                    <td width="30%">
                        <a class="comment">这这里这这里是备注这里是备注里是备注这这里是备注这里是备注里是备注是备注这里是备注里是备注</a>
                    </td>
                </tr>



                </tbody>
            </table>
        </div>
    </div>
    <div class="right-item">
        <table>
            <thead>
            <tr>
                <th width="6%">序号</th>
                <th width=6%">车次</th>
                <th width="15%">计划车号</th>
                <th width="8%">股道</th>
                <th width="15%">计划出库时间</th>
                <th width="10%">实际车号</th>
                <th width="15%">实际出库时间</th>
                <th width="25%">备注</th>
            </tr>
            </thead>
        </table>
        <div id="rightTable">
            <table>
                <thead>
                <tr>
                    <th width="6%">序号</th>
                    <th width=6%">车次</th>
                    <th width="15%">计划车号</th>
                    <th width="8%">股道</th>
                    <th width="15%">计划出库时间</th>
                    <th width="10%">实际车号</th>
                    <th width="15%">实际出库时间</th>
                    <th width="25%">备注</th>
                </tr>
                </thead>
                <tbody id="rightBody">
                <tr>
                    <td>1</td>
                    <td>0401</td>
                    <td>0417</td>
                    <td>01A</td>
                    <td><div class="time">2020-05-23 11:00</div></td>
                    <td width="30%">
                        <a class="comment">这这里这这里是备注这里是备注里是备注这这里是备注这里是备注里是备注是备注这里是备注里是备注</a>
                    </td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>0401</td>
                    <td>0417</td>
                    <td>01A</td>
                    <td><div class="time">2020-05-23 11:00</div></td>
                    <td width="30%">
                        <a class="comment">这这里这这里是备注这里是备注里是备注这这里是备注这里是备注里是备注是备注这里是备注里是备注</a>
                    </td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>0401</td>
                    <td>0417</td>
                    <td>01A</td>
                    <td><div class="time">2020-05-23 11:00</div></td>
                    <td width="30%">
                        <a class="comment">这这里这这里是备注这里是备注里是备注这这里是备注这里是备注里是备注是备注这里是备注里是备注</a>
                    </td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>0401</td>
                    <td>0417</td>
                    <td>01A</td>
                    <td><div class="time">2020-05-23 11:00</div></td>
                    <td width="30%">
                        <a class="comment">这这里这这里是备注这里是备注里是备注这这里是备注这里是备注里是备注是备注这里是备注里是备注</a>
                    </td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>0401</td>
                    <td>0417</td>
                    <td>01A</td>
                    <td><div class="time">2020-05-23 11:00</div></td>
                    <td width="30%">
                        <a class="comment">这这里这这里是备注这里是备注里是备注这这里是备注这里是备注里是备注是备注这里是备注里是备注</a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
</body>
<script src="js/jquery.min.js"></script>
<script src="js/common.js"></script>
<script src="js/jquery.mCustomScrollbar.concat.min.js"></script>
<script>
    $(function () {
        /***********隐藏滚动条***********/
        $("#rightTable").mCustomScrollbar({
            theme: "minimal"
        });
        $("#leftTable").mCustomScrollbar({
            theme: "minimal"
        });

        let fontSize = Number.parseInt(((window.screen.width) * 16) / 1920) + 'px'
        let h = window.innerHeight;
        let w = 120;
        if (window.innerWidth < 1920) {
            if (window.innerWidth == 1600) {
                w = 100
            } else if (window.innerWidth == 1440) {
                w = 90
            } else if (window.innerWidth == 1366) {
                w = 85
            }
        }
        document.querySelector('.table-box').style.height = (h - w) + 'px'
        /*******查询********/
      /*  $.ajax({
            type:'get',
            url:BASE_URL+'DTCGCW/zhxxtServer/zhxxtServerBean/findIpAndCd.action',
            dataType:'json',
            data:{},
            success:function (res) {
                console.log(res)
            },
            error:function (error) {
                console.log(error)
            }
        })*/
      var timer=null;
      timer=setInterval(function () {
          addWebSocket()
      },1000)
    })

    function addWebSocket() {
        var ws = new WebSocket("ws://localhost:8080/DTCGCW/ZhWebSocket.ws?cdid="+cdidx+'connectType=3');
        ws.onopen = function(){//连接成功
            console.info("open");
            let obj={'head':'GetAmOutTrainData',message:''}
            ws.send(JSON.stringify(obj))
        };
        ws.onmessage = function(evt) {//接收数据
            console.log( "Received Message: " + evt.data);
            if(evt.data==='开始')return
            if(evt.data.indexOf('结束')!=-1){
                return
            }else{
                let strList=''
                strList +=evt.data;
                bindData(strList)
            }
        };
    }
    function bindData(str) {//渲染table
        let arr=JSON.parse(str)
        let ltable=''
        let rtable=''
        for (let i=0;i<arr.length;i++){
            let tr=`<tr>
                           <td>${i+1}</td>
                           <td>${arr[i].trainNumber?arr[i].trainNumber:''}</td>
                           <td>${arr[i].planTrainNo?arr[i].planTrainNo:''}</td>
                           <td>${arr[i].stationTrack?arr[i].stationTrack:''}</td>
                           <td><div class="time">${arr[i].planOutDate}</div></td>
                            <td>${arr[i].realTrainNo?arr[i].realTrainNo:''}</td>
                             <td><div class="time">${arr[i].realOutDate?arr[i].realOutDate:''}</div></td>
                           <td >
                               <a class="comment">${arr[i].remark?arr[i].remark:''}</a>
                           </td>
                       </tr>`
            if(i%2==0){
                ltable+=tr
            }else{
                rtable+=tr
            }
        }
        $("#leftBody").html(ltable)
        $("#rightBody").html(rtable)
    }

</script>
</html>
